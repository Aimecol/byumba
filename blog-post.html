<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Blog Post - Diocese of Byumba</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" id="pageDescription" content="Read the latest blog post from the Diocese of Byumba">
    <meta name="keywords" id="pageKeywords" content="Diocese of Byumba, Catholic Church, Rwanda, Blog, Spiritual Reflection">
    <meta name="author" content="Diocese of Byumba">
    
    <!-- Open Graph Tags for Social Media -->
    <meta property="og:title" id="ogTitle" content="Blog Post - Diocese of Byumba">
    <meta property="og:description" id="ogDescription" content="Read the latest blog post from the Diocese of Byumba">
    <meta property="og:image" id="ogImage" content="images/logo/logo.png">
    <meta property="og:url" id="ogUrl" content="">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="Diocese of Byumba">
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" id="twitterTitle" content="Blog Post - Diocese of Byumba">
    <meta name="twitter:description" id="twitterDescription" content="Read the latest blog post from the Diocese of Byumba">
    <meta name="twitter:image" id="twitterImage" content="images/logo/logo.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Dynamic Header System -->
    <script src="js/header-manager.js"></script>
    <script src="js/header-loader.js"></script>
    
    <style>
        /* Blog Post Specific Styles */
        .blog-post-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .breadcrumb {
            background: #f8f9fa;
            padding: 15px 0;
            margin-bottom: 30px;
        }
        
        .breadcrumb-nav {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #666;
        }
        
        .breadcrumb-nav a {
            color: #1e753f;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .breadcrumb-nav a:hover {
            color: #2a8f4f;
        }
        
        .breadcrumb-separator {
            color: #999;
        }
        
        .blog-post-layout {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 40px;
            margin-bottom: 50px;
        }
        
        .blog-post-main {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .blog-post-header {
            margin-bottom: 30px;
        }
        
        .blog-post-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e753f;
            line-height: 1.2;
            margin-bottom: 20px;
        }
        
        .blog-post-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 14px;
        }
        
        .meta-item i {
            color: #1e753f;
        }
        
        .blog-post-image {
            width: 100%;
            height: 400px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #1e753f, #2a8f4f);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .blog-post-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-placeholder {
            font-size: 64px;
            color: rgba(255, 255, 255, 0.3);
        }
        
        .blog-post-content {
            font-size: 16px;
            line-height: 1.8;
            color: #333;
        }
        
        .blog-post-content h2 {
            font-size: 1.8rem;
            color: #1e753f;
            margin: 30px 0 15px 0;
        }
        
        .blog-post-content h3 {
            font-size: 1.4rem;
            color: #1e753f;
            margin: 25px 0 12px 0;
        }
        
        .blog-post-content p {
            margin-bottom: 20px;
            text-align: justify;
        }
        
        .blog-post-content blockquote {
            background: #f8f9fa;
            border-left: 4px solid #1e753f;
            padding: 20px;
            margin: 25px 0;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }
        
        .blog-post-tags {
            margin: 40px 0;
            padding: 20px 0;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
        }
        
        .tags-label {
            font-weight: 600;
            color: #1e753f;
            margin-bottom: 10px;
        }
        
        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .tag {
            background: #f0f8f4;
            color: #1e753f;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .tag:hover {
            background: #1e753f;
            color: white;
        }
        
        .social-sharing {
            margin: 30px 0;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .sharing-title {
            font-weight: 600;
            color: #1e753f;
            margin-bottom: 15px;
        }
        
        .sharing-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .share-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            border-radius: 25px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .share-facebook {
            background: #1877f2;
            color: white;
        }
        
        .share-twitter {
            background: #1da1f2;
            color: white;
        }
        
        .share-whatsapp {
            background: #25d366;
            color: white;
        }
        
        .share-email {
            background: #666;
            color: white;
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .blog-sidebar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 120px;
        }
        
        .sidebar-section {
            margin-bottom: 40px;
        }
        
        .sidebar-section:last-child {
            margin-bottom: 0;
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e753f;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f8f4;
        }
        
        .related-post {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .related-post:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .related-post-image {
            width: 80px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            background: linear-gradient(135deg, #1e753f, #2a8f4f);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .related-post-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .related-post-content h4 {
            font-size: 14px;
            font-weight: 600;
            color: #1e753f;
            line-height: 1.3;
            margin-bottom: 5px;
        }
        
        .related-post-content a {
            text-decoration: none;
            color: inherit;
        }
        
        .related-post-content a:hover h4 {
            color: #2a8f4f;
        }
        
        .related-post-date {
            font-size: 12px;
            color: #999;
        }
        
        .category-list {
            list-style: none;
            padding: 0;
        }
        
        .category-list li {
            margin-bottom: 10px;
        }
        
        .category-list a {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            color: #666;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .category-list a:hover {
            color: #1e753f;
        }
        
        .category-count {
            background: #f0f8f4;
            color: #1e753f;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        .newsletter-signup {
            background: linear-gradient(135deg, #1e753f, #2a8f4f);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .newsletter-signup h4 {
            margin-bottom: 10px;
        }
        
        .newsletter-signup p {
            font-size: 14px;
            margin-bottom: 20px;
            opacity: 0.9;
        }
        
        .newsletter-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .newsletter-form input {
            padding: 12px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .newsletter-form button {
            background: white;
            color: #1e753f;
            border: none;
            padding: 12px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .newsletter-form button:hover {
            background: #f0f8f4;
        }
        
        .post-navigation {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin: 40px 0;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .nav-post {
            flex: 1;
            text-decoration: none;
            color: inherit;
        }
        
        .nav-post-prev {
            text-align: left;
        }
        
        .nav-post-next {
            text-align: right;
        }
        
        .nav-label {
            font-size: 12px;
            color: #999;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .nav-title {
            font-weight: 600;
            color: #1e753f;
            transition: color 0.3s ease;
        }
        
        .nav-post:hover .nav-title {
            color: #2a8f4f;
        }
        
        .back-to-blog {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #1e753f;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }
        
        .back-to-blog:hover {
            background: #2a8f4f;
            transform: translateY(-2px);
        }
        
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #1e753f;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            opacity: 0;
            visibility: hidden;
        }
        
        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .back-to-top:hover {
            background: #2a8f4f;
            transform: translateY(-3px);
        }
        
        .print-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #666;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .print-button:hover {
            background: #555;
        }
        
        .comments-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-top: 40px;
        }
        
        .comments-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e753f;
            margin-bottom: 20px;
        }
        
        .comments-placeholder {
            text-align: center;
            padding: 40px;
            color: #666;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .blog-post-layout {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .blog-post-main {
                padding: 25px;
            }
            
            .blog-post-title {
                font-size: 2rem;
            }
            
            .blog-post-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .sharing-buttons {
                justify-content: center;
            }
            
            .post-navigation {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-post-prev,
            .nav-post-next {
                text-align: center;
            }
            
            .breadcrumb-nav {
                flex-wrap: wrap;
            }
        }
        
        /* Print Styles */
        @media print {
            .blog-sidebar,
            .social-sharing,
            .post-navigation,
            .comments-section,
            .back-to-blog,
            .back-to-top,
            .print-button {
                display: none !important;
            }
            
            .blog-post-layout {
                grid-template-columns: 1fr;
            }
            
            .blog-post-main {
                box-shadow: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Dynamic Header - Will be loaded by header-manager.js -->
    <header class="header" id="dynamicHeader">
        <!-- Header content will be dynamically updated based on authentication status -->
        <div class="header-loading" style="padding: 20px; text-align: center; background: linear-gradient(135deg, #1e753f 0%, #2a8f4f 100%); color: white;">
            <i class="fas fa-spinner fa-spin"></i> Loading header...
        </div>
    </header>

    <!-- Breadcrumb Navigation -->
    <div class="breadcrumb">
        <div class="container">
            <nav class="breadcrumb-nav">
                <a href="index.html">Home</a>
                <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                <a href="blog.html">Blog</a>
                <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                <span id="breadcrumbTitle">Blog Post</span>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="blog-post-container">
            <!-- Back to Blog Button -->
            <a href="blog.html" class="back-to-blog">
                <i class="fas fa-arrow-left"></i>
                Back to Blog
            </a>

            <div class="blog-post-layout">
                <!-- Main Blog Post Content -->
                <article class="blog-post-main">
                    <header class="blog-post-header">
                        <h1 class="blog-post-title" id="postTitle">Loading Blog Post...</h1>
                        
                        <div class="blog-post-meta">
                            <div class="meta-item">
                                <i class="fas fa-calendar-alt"></i>
                                <span id="postDate">December 15, 2024</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-user"></i>
                                <span id="postAuthor">Fr. Emmanuel Nzeyimana</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-clock"></i>
                                <span id="readingTime">5 min read</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-folder"></i>
                                <span id="postCategory">Spiritual Reflections</span>
                            </div>
                            <a href="#" class="print-button" onclick="window.print(); return false;">
                                <i class="fas fa-print"></i>
                                Print Article
                            </a>
                        </div>
                    </header>

                    <!-- Featured Image -->
                    <div class="blog-post-image" id="postImageContainer">
                        <i class="fas fa-image image-placeholder"></i>
                    </div>

                    <!-- Blog Post Content -->
                    <div class="blog-post-content" id="postContent">
                        <p>Loading blog post content...</p>
                    </div>

                    <!-- Tags -->
                    <div class="blog-post-tags">
                        <div class="tags-label">Tags:</div>
                        <div class="tag-list" id="postTags">
                            <a href="#" class="tag">Advent</a>
                            <a href="#" class="tag">Reflection</a>
                            <a href="#" class="tag">Prayer</a>
                            <a href="#" class="tag">Spiritual Growth</a>
                        </div>
                    </div>

                    <!-- Social Sharing -->
                    <div class="social-sharing">
                        <div class="sharing-title">Share this article:</div>
                        <div class="sharing-buttons">
                            <a href="#" class="share-btn share-facebook" id="shareFacebook">
                                <i class="fab fa-facebook-f"></i>
                                Facebook
                            </a>
                            <a href="#" class="share-btn share-twitter" id="shareTwitter">
                                <i class="fab fa-twitter"></i>
                                Twitter
                            </a>
                            <a href="#" class="share-btn share-whatsapp" id="shareWhatsApp">
                                <i class="fab fa-whatsapp"></i>
                                WhatsApp
                            </a>
                            <a href="#" class="share-btn share-email" id="shareEmail">
                                <i class="fas fa-envelope"></i>
                                Email
                            </a>
                        </div>
                    </div>
                </article>

                <!-- Sidebar -->
                <aside class="blog-sidebar">
                    <!-- Related Articles -->
                    <div class="sidebar-section">
                        <h3 class="sidebar-title">Related Articles</h3>
                        <div class="related-posts" id="relatedPosts">
                            <!-- Related posts will be loaded dynamically -->
                        </div>
                    </div>

                    <!-- Newsletter Signup -->
                    <div class="sidebar-section">
                        <div class="newsletter-signup">
                            <h4>Stay Updated</h4>
                            <p>Subscribe to our newsletter for the latest updates and spiritual insights.</p>
                            <form class="newsletter-form">
                                <input type="email" placeholder="Enter your email" required>
                                <button type="submit">Subscribe</button>
                            </form>
                        </div>
                    </div>
                </aside>
            </div>

            <!-- Post Navigation -->
            <nav class="post-navigation">
                <a href="#" class="nav-post nav-post-prev" id="prevPost">
                    <div class="nav-label">Previous Article</div>
                    <div class="nav-title">Youth Christmas Concert: December 23rd</div>
                </a>
                <a href="#" class="nav-post nav-post-next" id="nextPost">
                    <div class="nav-label">Next Article</div>
                    <div class="nav-title">Community Outreach: Supporting Local Families</div>
                </a>
            </nav>

            <!-- Comments Section -->
            <section class="comments-section">
                <h3 class="comments-title">Comments</h3>
                <div class="comments-placeholder">
                    <i class="fas fa-comments" style="font-size: 48px; color: #ddd; margin-bottom: 15px;"></i>
                    <p>Comments feature will be available soon. Stay tuned for community discussions!</p>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
               <div class="footer-section">
                    <h4 class="footer-title" data-translate="contact_information">Contact Information</h4>
                    <div class="contact-info">
                        <p><i class="fas fa-map-marker-alt"></i> Byumba, Northern Province, Rwanda</p>
                        <p><i class="fas fa-phone"></i> +250 788 123 456</p>
                        <p><i class="fas fa-envelope"></i> info@diocesebyumba.rw</p>
                    </div>
                </div>
                <div class="footer-section">
                    <h4 class="footer-title">Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Certificates</a></li>
                        <li><a href="jobs.html">Job Opportunities</a></li>
                        <li><a href="bishop-meeting.html">Bishop Meeting</a></li>
                        <li><a href="blog.html">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 class="footer-title">Follow Us</h4>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p data-translate="copyright">&copy; 2024 Diocese of Byumba. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <a href="#" class="back-to-top" id="backToTop">
        <i class="fas fa-chevron-up"></i>
    </a>

    <!-- Scripts -->
    <script src="js/script.js"></script>
    <script src="js/language.js"></script>

    <script>
        // Blog Post API Configuration
        const API_BASE_URL = 'api/blog-posts.php';

        // Cache for loaded blog posts
        let blogPostCache = {};

        /**
         * Fetch blog post data from API
         */
        async function fetchBlogPost(postSlug) {
            // Check cache first
            if (blogPostCache[postSlug]) {
                return blogPostCache[postSlug];
            }

            try {
                const response = await fetch(`${API_BASE_URL}?action=get_post&slug=${encodeURIComponent(postSlug)}`);
                const result = await response.json();

                if (result.success && result.data) {
                    // Cache the result
                    blogPostCache[postSlug] = result.data;
                    return result.data;
                } else {
                    console.error('Failed to fetch blog post:', result.error || 'Unknown error');
                    return null;
                }
            } catch (error) {
                console.error('Error fetching blog post:', error);
                return null;
            }
        }

        /**
         * Fetch related posts from API
         */
        async function fetchRelatedPosts(postId, limit = 3) {
            try {
                const response = await fetch(`${API_BASE_URL}?action=get_related_posts&post_id=${postId}&limit=${limit}`);
                const result = await response.json();

                if (result.success && result.data) {
                    return result.data;
                } else {
                    console.error('Failed to fetch related posts:', result.error || 'Unknown error');
                    return [];
                }
            } catch (error) {
                console.error('Error fetching related posts:', error);
                return [];
            }
        }

        /**
         * Increment post view count
         */
        async function incrementViewCount(postId) {
            try {
                await fetch(`${API_BASE_URL}?action=increment_views&post_id=${postId}`);
            } catch (error) {
                console.error('Error incrementing view count:', error);
            }
        }


        // Get post ID from URL parameters
        function getPostId() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('post') || 'advent-reflection';
        }

        // Load blog post content
        async function loadBlogPost() {
            const postSlug = getPostId();

            // Show loading state
            document.getElementById('postTitle').textContent = 'Loading...';
            document.getElementById('postContent').innerHTML = '<div class="loading-spinner">Loading blog post...</div>';

            try {
                // Fetch post from API
                let post = await fetchBlogPost(postSlug);

                // Fallback to hardcoded data if API fails
                if (!post && fallbackBlogPosts[postSlug]) {
                    post = fallbackBlogPosts[postSlug];
                    console.warn('Using fallback data for post:', postSlug);
                }

                if (!post) {
                    // Handle post not found
                    document.getElementById('postTitle').textContent = 'Post Not Found';
                    document.getElementById('postContent').innerHTML = '<p>The requested blog post could not be found.</p>';
                    return;
                }

                // Increment view count
                if (post.id) {
                    incrementViewCount(post.id);
                }

                // Update page title and meta tags
                document.title = post.title + ' - Diocese of Byumba';
                document.getElementById('pageTitle').textContent = post.title + ' - Diocese of Byumba';

                const description = post.seo_description || post.excerpt || post.content.substring(0, 160).replace(/<[^>]*>/g, '');
                const keywords = post.seo_keywords || (post.tags ? post.tags.join(', ') : '');

                document.getElementById('pageDescription').content = description;
                document.getElementById('pageKeywords').content = keywords;

                // Update Open Graph tags
                document.getElementById('ogTitle').content = post.title;
                document.getElementById('ogDescription').content = description;
                document.getElementById('ogUrl').content = window.location.href;

                // Update Twitter Card tags
                document.getElementById('twitterTitle').content = post.title;
                document.getElementById('twitterDescription').content = description;

                // Update breadcrumb
                document.getElementById('breadcrumbTitle').textContent = post.title;

                // Update post content
                document.getElementById('postTitle').textContent = post.title;
                document.getElementById('postDate').textContent = post.date;
                document.getElementById('postAuthor').textContent = post.author;
                document.getElementById('readingTime').textContent = post.reading_time || '5 min read';

                // Handle category display
                const categoryName = post.category_name || post.category || 'General';
                document.getElementById('postCategory').textContent = categoryName;
                document.getElementById('postContent').innerHTML = post.content;

                // Update featured image
                const imageContainer = document.getElementById('postImageContainer');
                if (post.featured_image) {
                    imageContainer.innerHTML = `<img src="${post.featured_image}" alt="${post.title}">`;
                } else {
                    imageContainer.innerHTML = '';
                }

                // Update tags
                const tagsContainer = document.getElementById('postTags');
                if (post.tags && post.tags.length > 0) {
                    tagsContainer.innerHTML = post.tags.map(tag =>
                        `<a href="blog.html?tag=${encodeURIComponent(tag)}" class="tag">${tag}</a>`
                    ).join('');
                } else {
                    tagsContainer.innerHTML = '';
                }

                // Setup social sharing
                setupSocialSharing(post);

                // Load related posts
                if (post.id) {
                    loadRelatedPosts(post.id);
                }

            } catch (error) {
                console.error('Error loading blog post:', error);
                document.getElementById('postTitle').textContent = 'Error Loading Post';
                document.getElementById('postContent').innerHTML = '<p>Sorry, there was an error loading this blog post. Please try again later.</p>';
            }
        }

        // Setup social sharing buttons
        function setupSocialSharing(post) {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent(post.title);
            const text = encodeURIComponent(post.seo?.description || post.title);

            document.getElementById('shareFacebook').href = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            document.getElementById('shareTwitter').href = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
            document.getElementById('shareWhatsApp').href = `https://wa.me/?text=${title}%20${url}`;
            document.getElementById('shareEmail').href = `mailto:?subject=${title}&body=${text}%0A%0A${url}`;
        }

        // Load related posts
        async function loadRelatedPosts(currentPostId) {
            const relatedContainer = document.getElementById('relatedPosts');

            try {
                // Fetch related posts from API
                const relatedPosts = await fetchRelatedPosts(currentPostId, 3);

                if (relatedPosts && relatedPosts.length > 0) {
                    displayRelatedPosts(relatedPosts);
                } else {
                    // Fallback to showing no related posts
                    relatedContainer.innerHTML = '<p>No related posts found.</p>';
                }
            } catch (error) {
                console.error('Error loading related posts:', error);
                relatedContainer.innerHTML = '<p>Unable to load related posts.</p>';
            }
        }

        // Display related posts
        function displayRelatedPosts(posts) {
            const relatedContainer = document.getElementById('relatedPosts');

            if (!posts || posts.length === 0) {
                relatedContainer.innerHTML = '<p style="color: #666; font-style: italic;">No related articles found.</p>';
                return;
            }

            relatedContainer.innerHTML = posts.map(post => `
                <div class="related-post">
                    <div class="related-post-image">
                        ${post.featured_image ?
                            `<img src="${post.featured_image}" alt="${post.title}" style="width: 100%; height: 100%; object-fit: cover;">` :
                            '<i class="fas fa-image" style="color: rgba(255,255,255,0.3); font-size: 20px;"></i>'
                        }
                    </div>
                    <div class="related-post-content">
                        <a href="blog-post.html?post=${post.slug}">
                            <h4>${post.title}</h4>
                        </a>
                        <div class="related-post-date">${post.date}</div>
                        <div class="related-post-reading-time">${post.reading_time || '5 min read'}</div>
                    </div>
                </div>
            `).join('');
        }

        // Back to top functionality
        function setupBackToTop() {
            const backToTopBtn = document.getElementById('backToTop');

            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('visible');
                } else {
                    backToTopBtn.classList.remove('visible');
                }
            });

            backToTopBtn.addEventListener('click', (e) => {
                e.preventDefault();
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }

        // Newsletter signup
        function setupNewsletterSignup() {
            const form = document.querySelector('.newsletter-form');
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = form.querySelector('input[type="email"]').value;

                // In a real application, this would send the email to a server
                alert('Thank you for subscribing! You will receive our latest updates.');
                form.reset();
            });
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            loadBlogPost();
            setupBackToTop();
            setupNewsletterSignup();
        });
    </script>
</body>
</html>
